<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"github.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
<meta property="og:type" content="website">
<meta property="og:title" content="记录与分享">
<meta property="og:url" content="https://github.com/Linkontoask/index.html">
<meta property="og:site_name" content="记录与分享">
<meta property="og:description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Link">
<meta property="article:tag" content="blog">
<meta property="article:tag" content="Link">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://github.com/Linkontoask/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>记录与分享</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">记录与分享</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Link</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/Linkontoask/2021/07/07/%E8%B7%AF%E7%94%B1%E5%99%A8%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Link">
      <meta itemprop="description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="记录与分享">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/07/%E8%B7%AF%E7%94%B1%E5%99%A8%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">路由器进行科学上网配置</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-07-07 14:22:43 / 修改时间：03:46:43" itemprop="dateCreated datePublished" datetime="2021-07-07T14:22:43+00:00">2021-07-07</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="为什么要折腾路由器呢？"><a href="#为什么要折腾路由器呢？" class="headerlink" title="为什么要折腾路由器呢？"></a>为什么要折腾路由器呢？</h2><p>原因有如下几种</p>
<ul>
<li>终端设备太多了（安卓、 iPhone 、 windows …），在某些设备上没办法直接下载对应的工具。</li>
<li>利用路由器做内网穿透，nas。</li>
<li>丰富的软件。</li>
</ul>
<p>其中首当其冲的好处就是，可以很快的阅读 GitHub 、学习。</p>
<p>如果家里只有 1 台或者 2 台设备，建议不要折腾路由器，毕竟折腾确实耗费精力，花了我接近6个小时的时间，当然其中走了很多弯路。所以，写下这篇文章提高办事效率。</p>
<h2 id="安装前提条件"><a href="#安装前提条件" class="headerlink" title="安装前提条件"></a>安装前提条件</h2><p>一定要清楚自己的路由器型号，这篇文章基于如下环境进行介绍，如果和你的环境有出入，请自行 baidu 。（型号太多，没时间折腾，文末会给出相关文档链接）</p>
<ul>
<li>清楚当前路由器地址，还得知道密码。一般是 （192.168.2.1 / 192.168.1.2 / 192.168.1.1）</li>
<li><code>斐讯K3路由器</code></li>
</ul>
<h3 id="第一步，登陆后台"><a href="#第一步，登陆后台" class="headerlink" title="第一步，登陆后台"></a>第一步，登陆后台</h3><p>登陆完成后参考 <a href="https://tbvv.net/posts/0101-k3.html" target="_blank" rel="noopener">tb 链接</a> 文档，对路由器进行固件刷机，我们选择官方root版本，如果直接刷 openwrt 固件会造成文件损坏进入 mini server 界面，这时候我们就要从头开始了。</p>
<ul>
<li>打开<a href="https://tbvv.net/posts/0101-k3.html" target="_blank" rel="noopener">tb 链接</a></li>
<li>跳转到固件下载栏目，选择 <code>K3_V21.5.37.246_tb.bin</code>文件并下载</li>
<li>跳转到刷入root固件栏目，按照说明进行配置</li>
</ul>
<p>以上步骤完成之后，我们可以用 <code>ssh</code> 工具连接进我们的路由器后台。</p>
<ul>
<li>使用 用户名：<code>admin</code>， 密码：<code>admin</code> 连接后台。</li>
<li>输入 <code>tb</code> 后回车</li>
<li>依次选择 <code>CFE降级</code>（具体的数字忘记了，这里就用中文代替）</li>
<li>选择后继续选择刷入 <code>openwrt / lede</code> 固件，这里选择其中一个就好，最后等待完成。（注意：有些后台 IP 有变化，请注意看命令行提示）</li>
</ul>
<p><strong>最后要看一下 openwrt 的密码，有些是需要输入密码才能进入的。</strong></p>
<h3 id="第二步，用网页登陆"><a href="#第二步，用网页登陆" class="headerlink" title="第二步，用网页登陆"></a>第二步，用网页登陆</h3><p>下载 <a href="https://u.nu/4sir" target="_blank" rel="noopener">openwrt 固件</a>，下载不了请联系 linkorgs#163.com (# -&gt; @)。</p>
<p>登陆完成后在 【系统-备份/升级】中上传刷写上面下载的固件。等待系统完成。</p>
<h3 id="第三步，打开服务"><a href="#第三步，打开服务" class="headerlink" title="第三步，打开服务"></a>第三步，打开服务</h3><p>依然使用账号密码在 192.168.2.1 登陆控制台，然后选择【服务-ShadowSocketsR PLus+-填入订阅的节点链接 / 填写对应的服务器信息】，保存并应用即可。</p>
<h3 id="最后一步，测试是否成功"><a href="#最后一步，测试是否成功" class="headerlink" title="最后一步，测试是否成功"></a>最后一步，测试是否成功</h3><p>用终端设备打开 <a href="google.com">google.com</a>，打开成功则表示配置成功，失败请测试节点是否可用。</p>
<p>使用 ssh 登陆后台，用户名：root，密码：netflixcn.com</p>
<p>密码也是网页的登陆密码，可以在系统里面设置。</p>
<p>至此，我们已经可以通过 <code>ssh</code> 连接进路由器，使用 <code>openwrt</code> 的插件 <code>ShadowSocketsR PLus+</code> 进行科学上网。</p>
<p>分享是互联网的精神。</p>
<h4 id="相关文档"><a href="#相关文档" class="headerlink" title="相关文档"></a>相关文档</h4><p><a href="https://netflixcn.com/miji/50.html" target="_blank" rel="noopener">openwrt 固件文档</a><br><a href="https://tbvv.net/posts/0101-k3.html" target="_blank" rel="noopener">官方 root 固件文档</a></p>
<p>上面说明步骤均未配图，不明白可以看上述文档。最后请勿拿来做违法的事情</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/Linkontoask/2020/09/16/Vue3%E4%B8%8EReact%E5%92%8CSvelte%E7%9A%84%E5%8C%BA%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Link">
      <meta itemprop="description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="记录与分享">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/16/Vue3%E4%B8%8EReact%E5%92%8CSvelte%E7%9A%84%E5%8C%BA%E5%88%AB/" class="post-title-link" itemprop="url">Vue3与React和Svelte的区别</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-16 10:52:09" itemprop="dateCreated datePublished" datetime="2020-09-16T10:52:09+00:00">2020-09-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-07 03:46:43" itemprop="dateModified" datetime="2021-07-07T03:46:43+00:00">2021-07-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>vue和react是前端开发中最流行的两种框架，它们在运行时进行工作，svelte利用编译优化思想，在编译过程中将顶层变量变更为响应式。</p>
<p><strong>Vue3</strong>目前已经在rc阶段，和之前（vue2）一样，但是在代码组织结构与逻辑复用上有很大的改变。在vue2阶段，实现逻辑服用基本上靠mixin，但是mixin无法预知内部状态，会造成代码混乱，难以维护。</p>
<p>Vue3为了解决上述难题推出<a href="https://v3.vuejs.org/guide/composition-api-introduction.html#why-composition-api" target="_blank" rel="noopener">Composition API</a>。</p>
<blockquote>
<p>Creating Vue components allows us to extract repeatable parts of the interface coupled with its functionality into reusable pieces of code. This alone can get our application pretty far in terms of maintainability and flexibility. However, our collective experience has proved that this alone might not be enough, especially when your application is getting really big – think several hundreds of components. When dealing with such large applications, sharing and reusing code becomes especially important.</p>
</blockquote>
<p>Composition API是为了构建大型可复用组件，在符合代码书写的前提下完成了逻辑复用。更多关于Composition API请参阅<a href="https://v3.vuejs.org/guide/composition-api-introduction.html" target="_blank" rel="noopener">指南</a>。这里要注意，Composition API中有一个很关键的概念<code>setup</code>，所有Composition API都编写在<code>setup</code>中，它在声明周期中位于<code>created</code>之前，所以在使用生命周期函数时请不要使用<code>beforeCreate</code>和<code>created</code>，更多请参与<a href="https://v3.vuejs.org/guide/composition-api-lifecycle-hooks.html" target="_blank" rel="noopener">指南</a>。请不要在<code>setup</code>中使用<code>this</code>，this不是当前实例的引用，而是<code>undefined</code>，所以尽量不要和其它<code>Options API</code>一起使用。</p>
<h3 id="Vue3中的Composition-API和React的Hooks有什么区别呢？"><a href="#Vue3中的Composition-API和React的Hooks有什么区别呢？" class="headerlink" title="Vue3中的Composition API和React的Hooks有什么区别呢？"></a>Vue3中的Composition API和React的Hooks有什么区别呢？</h3><p><strong>Vue3</strong>中的Composition API在setup中编写，这个函数只会执行一次，而React在某些情况下会调用多次（比如定时请求），具体如下：</p>
<ul>
<li>一般来说更符合惯用的 JavaScript 代码的直觉；</li>
<li>不需要顾虑调用顺序，也可以用在条件语句中；</li>
<li>不会在每次渲染时重复执行，以降低垃圾回收的压力；</li>
<li>不存在内联处理函数导致子组件永远更新的问题，也不需要 useCallback；</li>
<li>不存在忘记记录依赖的问题，也不需要“useEffect”和“useMemo”并传入依赖数组以捕获过时的变量。Vue 的自动依赖跟踪可以确保侦听器和计算值总是准确无误。</li>
</ul>
<p>注：上述信息来源于<a href="https://composition-api.vuejs.org/zh/" target="_blank" rel="noopener">Vue 组合式 API</a></p>
<h3 id="Vue3中的Composition-API和Svelte有什么区别呢？"><a href="#Vue3中的Composition-API和Svelte有什么区别呢？" class="headerlink" title="Vue3中的Composition API和Svelte有什么区别呢？"></a>Vue3中的Composition API和Svelte有什么区别呢？</h3><p>Svelte与React、Vue、Ag不同，他利用编译的思想进行代码组织编写。它也没有使用虚拟DOM差异技术，而是通过封装过的代码进行DOM更新，以下是Svelte的输出。</p>
<blockquote>
<p>Svelte is a component framework — like React or Vue — but with an important difference. Traditional frameworks allow you to write declarative state-driven code, but there’s a penalty: the browser must do extra work to convert those declarative structures into DOM operations, using techniques like  that eat into your frame budget and tax the garbage collector.</p>
</blockquote>
<blockquote>
<p>Instead, Svelte runs at build time, converting your components into highly efficient imperative code that surgically updates the DOM. As a result, you’re able to write ambitious applications with excellent performance characteristics.</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">let</span> name = <span class="string">'world'</span>;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello &#123;name&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>以上代码经过Svelte的编译之后会输出如下代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* App.svelte generated by Svelte v3.25.1 */</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">	SvelteComponent,</span><br><span class="line">	detach,</span><br><span class="line">	element,</span><br><span class="line">	init,</span><br><span class="line">	insert,</span><br><span class="line">	noop,</span><br><span class="line">	safe_not_equal</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"svelte/internal"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">create_fragment</span>(<span class="params">ctx</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">let</span> h1;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		c() &#123;</span><br><span class="line">			h1 = element(<span class="string">"h1"</span>);</span><br><span class="line">			h1.textContent = <span class="string">`Hello <span class="subst">$&#123;name&#125;</span>!`</span>;</span><br><span class="line">		&#125;,</span><br><span class="line">		m(target, anchor) &#123;</span><br><span class="line">			insert(target, h1, anchor);</span><br><span class="line">		&#125;,</span><br><span class="line">		p: noop,</span><br><span class="line">		i: noop,</span><br><span class="line">		o: noop,</span><br><span class="line">		d(detaching) &#123;</span><br><span class="line">			<span class="keyword">if</span> (detaching) detach(h1);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> name = <span class="string">"world"</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">SvelteComponent</span> </span>&#123;</span><br><span class="line">	<span class="keyword">constructor</span>(options) &#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		init(<span class="keyword">this</span>, options, <span class="literal">null</span>, create_fragment, safe_not_equal, &#123;&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure>

<p>在<strong>Vue3</strong>中，不需要借助编译器（webpack、rollup）的帮助，可以直接运行在浏览器侧或服务器（ssr）侧。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-cn"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"module"</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">'https://unpkg.com/vue@3.0.0-rc.10/dist/vue.esm-browser.js'</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">const</span> App = createApp(&#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: `<span class="tag">&lt;<span class="name">button</span>&gt;</span>change A value<span class="tag">&lt;/<span class="name">button</span>&gt;</span>`,</span></span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    App.mount(<span class="string">'#root'</span>)</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>从以上代码可以看出来，它们分别有自己的优劣势：</p>
<ul>
<li>Svelte 的代码看起来更简洁，但是已经不属于标准 JavaScript。</li>
<li>Svelte 编译更快，但是不适合构建大型应用，因为它的社区目前来说没有Vue、React庞大。</li>
<li>Svelte 响应只有顶层变量，函数内部声明的变量并不具有响应性。</li>
<li>Svelte 很难集成TypeScript，难以利用社区优势构建应用。</li>
</ul>
<h3 id="最终结论"><a href="#最终结论" class="headerlink" title="最终结论"></a>最终结论</h3><p>Vue3的Composition API是Vue发展过程的产物，是为了解决构建大型应用逻辑代码复用问题。相比Vue2配置型API，我更倾向于Vue3的Composition API。</p>
<p>Svelte的思想是非常先进的，基于编译优化的思想在没有diff情况下性能并没有很大的区别。</p>
<p>参考链接：</p>
<ul>
<li><a href="https://svelte.dev/" target="_blank" rel="noopener">https://svelte.dev/</a></li>
<li><a href="https://v3.vuejs.org/" target="_blank" rel="noopener">https://v3.vuejs.org/</a></li>
<li><a href="https://composition-api.vuejs.org/" target="_blank" rel="noopener">https://composition-api.vuejs.org/</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/Linkontoask/2020/09/04/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1vue2%E5%8D%87%E7%BA%A7%E5%88%B0vue3%E7%9A%84%E8%BF%87%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Link">
      <meta itemprop="description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="记录与分享">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/04/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1vue2%E5%8D%87%E7%BA%A7%E5%88%B0vue3%E7%9A%84%E8%BF%87%E7%A8%8B/" class="post-title-link" itemprop="url">记录一次vue2升级到vue3的过程</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-04 14:22:43" itemprop="dateCreated datePublished" datetime="2020-09-04T14:22:43+00:00">2020-09-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-07 03:46:43" itemprop="dateModified" datetime="2021-07-07T03:46:43+00:00">2021-07-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="从vue2升级到vue3的应该做什么？"><a href="#从vue2升级到vue3的应该做什么？" class="headerlink" title="从vue2升级到vue3的应该做什么？"></a>从vue2升级到vue3的应该做什么？</h1><p>最近在升级<a href="https://linkorg.club/" target="_blank" rel="noopener">v-easy-components</a>到<code>2.0.0</code>版本时候，发现了一些升级过程中的问题，总结一下，希望能帮到从vue2升级到vue3的项目。</p>
<h2 id="emit-需要主动声明"><a href="#emit-需要主动声明" class="headerlink" title="emit 需要主动声明"></a>emit 需要主动声明</h2><p>在<code>.vue</code>组件中，使用<code>this.$emit(&#39;emitName&#39;)</code>时，不需要主动声明emit的第一个参数，在vue3中，必须主动声明<code>emits</code>，她接受数组，写法如下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div @click="$emit('click')"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">  emits: [<span class="string">'click'</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果不主动声明，在使用组件时监听<code>click</code>事件，会触发两次。</p>
<h2 id="v-model可以指定值，默认为modelValue"><a href="#v-model可以指定值，默认为modelValue" class="headerlink" title="v-model可以指定值，默认为modelValue"></a>v-model可以指定值，默认为modelValue</h2><p>在vue2中使用<code>v-model</code>默认为value（单选框、复选框等类型的输入控件不同），在vue3中支持自定义value，可以使用<code>v-model:value=&quot;value&quot;</code>支持vue2。也可以用<code>$emit(&#39;update:modelValue&#39;)</code>支持<code>v-model=&quot;value&quot;</code>，这取决于你可以（愿意）修改哪部分代码。</p>
<p>以下为修改子组件的形式。更多信息参考<a href="https://v3.vuejs.org/guide/migration/v-model.html#overview" target="_blank" rel="noopener">https://v3.vuejs.org/guide/migration/v-model.html#overview</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp, ref &#125; <span class="keyword">from</span> <span class="string">'https://unpkg.com/vue@3.0.0-rc.9/dist/vue.esm-browser.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> App = createApp(&#123;</span><br><span class="line">    template: <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;message v-model="value" /&gt;</span></span><br><span class="line"><span class="string">      &lt;button @click="value += 1"&gt;change A value&lt;/button&gt;</span></span><br><span class="line"><span class="string">    `</span>,</span><br><span class="line">    setup: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> value = ref(<span class="number">0</span>)</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Message = &#123;</span><br><span class="line">  name: <span class="string">'Message'</span>,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">      &lt;span&gt;&#123;&#123; modelValue &#125;&#125;&lt;/span&gt;</span></span><br><span class="line"><span class="string">      &lt;button @click="$emit('update:modelValue', (modelValue+1))"&gt;change B value&lt;/button&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">  props: &#123;</span><br><span class="line">    modelValue: <span class="built_in">Number</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">App.component(Message.name, Message)</span><br><span class="line"></span><br><span class="line">App.mount(<span class="string">'#root'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="完全移除this-set"><a href="#完全移除this-set" class="headerlink" title="完全移除this.$set"></a>完全移除this.$set</h2><p>vue3最大的改变之一就是使用<code>Proxy</code>。【Proxy 用于修改某些操作的默认行为，等同于在语言层面做出修改，所以属于一种“元编程”（meta programming），即对编程语言进行编程。】①</p>
<p>在项目架构中，分离了响应式系统，vue3中的响应式API可以剥离出来单独使用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, computed &#125; <span class="keyword">from</span> <span class="string">'@vue/reactivity'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> count = ref(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">const</span> plusOne = computed(<span class="function"><span class="params">()</span> =&gt;</span> count.value + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(plusOne.value) <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">plusOne.value++ <span class="comment">// error</span></span><br></pre></td></tr></table></figure>

<h2 id="使用config-globalProperties代替Vue-prototype"><a href="#使用config-globalProperties代替Vue-prototype" class="headerlink" title="使用config.globalProperties代替Vue.prototype"></a>使用config.globalProperties代替Vue.prototype</h2><p>现在提倡函数式编程，Vue也抛弃了2的new形式实例化一个组件，改用<code>createApp</code>创建，所以我们不能再使用<code>Vue.prototype</code>创建组件通用方法，更改为<code>app.config.globalProperties.attr = () =&gt; {}</code>这种形式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Before</span></span><br><span class="line">Vue.prototype.$http = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// After</span></span><br><span class="line"><span class="keyword">const</span> app = Vue.createApp(&#123;&#125;)</span><br><span class="line">app.config.globalProperties.$http = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="自定义命令的改变"><a href="#自定义命令的改变" class="headerlink" title="自定义命令的改变"></a>自定义命令的改变</h2><p>vue2自定义指令文档在这里<a href="https://vuejs.org/v2/guide/custom-directive.html#Hook-Functions" target="_blank" rel="noopener">https://vuejs.org/v2/guide/custom-directive.html#Hook-Functions</a>，vue3自定义指令文档在这里<a href="https://v3.vuejs.org/api/application-api.html#directive" target="_blank" rel="noopener">https://v3.vuejs.org/api/application-api.html#directive</a>。自定义指令在升级过程中暂未发现特别需要注意的地方，按照文档更新即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue2</span></span><br><span class="line">Vue.directive(<span class="string">'demo'</span>, &#123;</span><br><span class="line">  bind: <span class="function"><span class="keyword">function</span> (<span class="params">el, binding, vnode</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> s = <span class="built_in">JSON</span>.stringify</span><br><span class="line">    el.innerHTML =</span><br><span class="line">      <span class="string">'name: '</span>       + s(binding.name) + <span class="string">'&lt;br&gt;'</span> +</span><br><span class="line">      <span class="string">'value: '</span>      + s(binding.value) + <span class="string">'&lt;br&gt;'</span> +</span><br><span class="line">      <span class="string">'expression: '</span> + s(binding.expression) + <span class="string">'&lt;br&gt;'</span> +</span><br><span class="line">      <span class="string">'argument: '</span>   + s(binding.arg) + <span class="string">'&lt;br&gt;'</span> +</span><br><span class="line">      <span class="string">'modifiers: '</span>  + s(binding.modifiers) + <span class="string">'&lt;br&gt;'</span> +</span><br><span class="line">      <span class="string">'vnode keys: '</span> + <span class="built_in">Object</span>.keys(vnode).join(<span class="string">', '</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// vue3</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">const</span> app = createApp(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// register</span></span><br><span class="line">app.directive(<span class="string">'my-directive'</span>, &#123;</span><br><span class="line">  <span class="comment">// Directive has a set of lifecycle hooks:</span></span><br><span class="line">  <span class="comment">// called before bound element's parent component is mounted</span></span><br><span class="line">  beforeMount() &#123;&#125;,</span><br><span class="line">  <span class="comment">// called when bound element's parent component is mounted</span></span><br><span class="line">  mounted() &#123;&#125;,</span><br><span class="line">  <span class="comment">// called before the containing component's VNode is updated</span></span><br><span class="line">  beforeUpdate() &#123;&#125;,</span><br><span class="line">  <span class="comment">// called after the containing component's VNode and the VNodes of its children // have updated</span></span><br><span class="line">  updated() &#123;&#125;,</span><br><span class="line">  <span class="comment">// called before the bound element's parent component is unmounted</span></span><br><span class="line">  beforeUnmount() &#123;&#125;,</span><br><span class="line">  <span class="comment">// called when the bound element's parent component is unmounted</span></span><br><span class="line">  unmounted() &#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="nextTick的改变"><a href="#nextTick的改变" class="headerlink" title="nextTick的改变"></a>nextTick的改变</h2><p>在vue2中，在组件实例上可以使用<code>this.$nextTick</code>，它会在渲染之后调用。在vue3中，它变成了一个全局API，需要<code>import { nextTick } from &#39;vue&#39;</code>这样引用。vue3节省了一个实例所占用js内存，以下附两张不同版本的实例截图。</p>
<p>Vue2<br><img src="../image/vue2.png" alt="Vue2"></p>
<p>Vue3<br><img src="../image/vue3.png" alt="Vue3"></p>
<h2 id="使用definecomponent来进行类型推导"><a href="#使用definecomponent来进行类型推导" class="headerlink" title="使用definecomponent来进行类型推导"></a>使用definecomponent来进行类型推导</h2><p>当项目中使用typescript时，可以使用definecomponent，它什么也不做，只会进行类型推导，让我们在使用时可以知道参数的类型。<a href="https://v3.vuejs.org/api/global-api.html#definecomponent" target="_blank" rel="noopener">https://v3.vuejs.org/api/global-api.html#definecomponent</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; definecomponent &#125; <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> definecomponent(&#123;</span><br><span class="line">  name: <span class="string">''</span>,</span><br><span class="line">  setup() &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>① <a href="https://es6.ruanyifeng.com/#docs/proxy#%E6%A6%82%E8%BF%B0" target="_blank" rel="noopener">https://es6.ruanyifeng.com/#docs/proxy#%E6%A6%82%E8%BF%B0</a></p>
<p>更新时间：2020.09.04</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/Linkontoask/2020/08/24/%E4%BB%80%E4%B9%88%E6%98%AFPromise-A-%EF%BC%9F%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAthen%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Link">
      <meta itemprop="description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="记录与分享">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/24/%E4%BB%80%E4%B9%88%E6%98%AFPromise-A-%EF%BC%9F%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAthen%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8%EF%BC%9F/" class="post-title-link" itemprop="url">什么是Promises/A+？如何实现一个then链式调用？</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-24 15:59:24" itemprop="dateCreated datePublished" datetime="2020-08-24T15:59:24+00:00">2020-08-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-07 03:46:43" itemprop="dateModified" datetime="2021-07-07T03:46:43+00:00">2021-07-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="什么是Promises-A-规范？"><a href="#什么是Promises-A-规范？" class="headerlink" title="什么是Promises/A+规范？"></a>什么是Promises/A+规范？</h1><p>是Promise的一个非常稳定标准，用于给实现该标准的一个说明。他规范了then方法的行为，使得同一份代码在不同平台也能拥有相同效果。</p>
<p><a href="https://promisesaplus.com/" target="_blank" rel="noopener">https://promisesaplus.com/</a>这里有一个详细的解释。</p>
<h1 id="实现then链式调用"><a href="#实现then链式调用" class="headerlink" title="实现then链式调用"></a>实现then链式调用</h1><p>Promise语法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;&#125; <span class="comment">/* executor */</span>  );</span><br></pre></td></tr></table></figure>

<h2 id="executor"><a href="#executor" class="headerlink" title="executor"></a>executor</h2><p>executor是带有 <code>resolve</code> 和 <code>reject</code> 两个参数的函数 。Promise构造函数执行时立即调用 <code>executor</code> 函数， <code>resolve</code> 和 <code>reject</code> 两个函数作为参数传递给executor（executor 函数在Promise构造函数返回所建promise实例对象前被调用）。<code>resolve</code> 和 <code>reject</code> 函数被调用时，分别将promise的状态改为<code>fulfilled</code>（完成）或<code>rejected</code>（失败）。executor 内部通常会执行一些异步操作，一旦异步操作执行完毕(可能成功/失败)，要么调用resolve函数来将promise状态改成<code>fulfilled</code>，要么调用 reject 函数将 promise 的状态改为 <code>rejected</code>。如果在executor函数中抛出一个错误，那么该promise 状态为<code>rejected</code>。executor函数的返回值被忽略。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(</span><br><span class="line">    (resolve, reject) =&gt; &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            resolve(<span class="number">100</span>)</span><br><span class="line">        &#125;, <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">).then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(v) <span class="comment">// 100</span></span><br><span class="line">&#125;, e =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e) <span class="comment">//</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>上面是一个经典的Promise例子，使用<code>setTimeout</code>延迟将100返回给<code>then</code>方法使用。那么，我们为了实现上面的功能，应该提前做哪些准备呢？</p>
<ul>
<li>executor立即执行，那么我们需要在new一个实例的时候，直接执行executor，并传入<code>resolve</code>，<code>reject</code>。</li>
<li>then方法返回一个Promise，接收两个参数，<code>promise.then(onFulfilled?: Function, onRejected?: Function)</code>，<code>onFulfilled</code>和<code>onRejected</code>必须为函数，分别在成功或失败后调用。</li>
<li><code>resolve</code>或<code>reject</code>的值需要传递给下一个<code>then</code>方法中的<code>onFulfilled</code>或<code>onRejected</code>。</li>
<li>Promise只有一个状态，初始状态为<code>pending</code>。<code>fulfilled</code>/<code>rejected</code>状态为最终状态，不能转换为其它状态。</li>
</ul>
<p>有了上述准备，接下来使用伪代码实现一个demo。（使用伪代码的原因是因为在给别人演示或面试时可以提高效率，避免在细节上花太多的时间）</p>
<p>以下为ES6的代码，ES5可以使用function和prototype实现。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xPromise</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(executor) &#123;</span><br><span class="line">        <span class="keyword">const</span> resolve = <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> reject = <span class="function"><span class="params">reson</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line">        executor(resolve, reject)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    then(onFulfilled, onRejected) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> xPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                onFulfilled(<span class="keyword">this</span>.value)</span><br><span class="line">            &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">                onRejected(e)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> promise1 = <span class="keyword">new</span> xPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="number">100</span>)</span><br><span class="line">&#125;)</span><br><span class="line">promise1.then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(v) <span class="comment">// 100</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'end'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 控制台输出：</span></span><br><span class="line"><span class="comment"> * 100</span></span><br><span class="line"><span class="comment"> * end</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p>为什么先输出100？再输出end呢？</p>
<p>原因在于then方法中执行<code>onFulfilled</code>/<code>onRejected</code>为同步执行，那么，我们将<code>then</code>方法稍加修改。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">then(onFulfilled, onRejected) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> xPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> onFulfill = <span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">                process.nextTick() <span class="comment">// This can be implemented with either a “macro-task” mechanism such as setTimeout or setImmediate, or with a “micro-task” mechanism such as MutationObserver or process.nextTick</span></span><br><span class="line">            &#125;</span><br><span class="line">            onFulfill(<span class="keyword">this</span>.value)</span><br><span class="line">        &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">            <span class="keyword">const</span> onReject = <span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">                process.nextTick()</span><br><span class="line">            &#125;</span><br><span class="line">            onReject(e)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 控制台输出：</span></span><br><span class="line"><span class="comment"> * end</span></span><br><span class="line"><span class="comment"> * 100</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p>现在输出已经符合预期，那么我们看看最初那个经典的例子。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> xPromise(</span><br><span class="line">    (resolve, reject) =&gt; &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            resolve(<span class="number">100</span>)</span><br><span class="line">        &#125;, <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">).then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(v) <span class="comment">// 100</span></span><br><span class="line">&#125;, e =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e) <span class="comment">//</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 控制台输出：</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p>怎么回事，我们的输入呢？很明显，没有进入到<code>then</code>方法中，为什么会产生这样子的效果，原因时因为执行<code>executor</code>时，使用了<code>setTimeout</code>这个定时器函数，那我们可以换一种思路，在<code>then</code>方法中不直接调用传递进来的参数，而是使用一个数组将参数保存下来，在<code>resolve</code>中再循环执行这个数组中的函数。那应该怎么改呢？</p>
<p>构造函数中初始化两个数组，分别保存<code>onFulfilled</code>/<code>onRejected</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xPromise</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(executor) &#123;</span><br><span class="line">        <span class="keyword">this</span>.resolveCallback = []</span><br><span class="line">        <span class="keyword">this</span>.rejectCallback = []</span><br><span class="line">        <span class="keyword">const</span> resolve = <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">            <span class="keyword">this</span>.resolveCallback.forEach(<span class="function"><span class="params">f</span> =&gt;</span> f())</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> reject = <span class="function"><span class="params">reson</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">            <span class="keyword">this</span>.rejectCallback.forEach(<span class="function"><span class="params">f</span> =&gt;</span> f())</span><br><span class="line">        &#125;</span><br><span class="line">        executor(resolve, reject)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    then(onFulfilled, onRejected) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> xPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> onFulfill = <span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">                process.nextTick() <span class="comment">// This can be implemented with either a “macro-task” mechanism such as setTimeout or setImmediate, or with a “micro-task” mechanism such as MutationObserver or process.nextTick</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">const</span> onReject = <span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">                process.nextTick()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.resolveCallback.push(onFulfill)</span><br><span class="line">            <span class="keyword">this</span>.rejectCallback.push(onReject)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'start'</span>)</span><br><span class="line"><span class="keyword">new</span> xPromise(</span><br><span class="line">    (resolve, reject) =&gt; &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            resolve(<span class="number">100</span>)</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">).then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(v) <span class="comment">// 100</span></span><br><span class="line">&#125;, e =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e) <span class="comment">//</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'end'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 控制台输出：</span></span><br><span class="line"><span class="comment"> * start</span></span><br><span class="line"><span class="comment"> * end</span></span><br><span class="line"><span class="comment"> * -&gt; 1s后输出 &lt;100&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p>到现在为止，我们实现了<code>then</code>方法，那么如何在链式调用时穿透值呢？其实很简单，我们只需要在<code>resolve</code>时候把值保存起来，在callback遍历时传递进去即可。不过，我们还需要注意<code>then</code>方法可能会返回一个Promise，所以，在<code>onFulfill</code>/<code>onReject</code>中需要使用<code>instanceof</code>判断函数执行的返回值是否为Promise。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">then(onFulfilled, onRejected) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> xPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> onFulfill = <span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> fn = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                     * 使用 instanceof 判断，然后调用then方法使用resolve传递出去</span></span><br><span class="line"><span class="comment">                     */</span></span><br><span class="line">                    <span class="keyword">const</span> result = onFulfilled(v)</span><br><span class="line">                    <span class="keyword">if</span> (result <span class="keyword">instanceof</span> xPromise) &#123;</span><br><span class="line">                        result.then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">                            resolve(v)</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// ...</span></span><br><span class="line">                &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">                    <span class="comment">// ...</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            process.nextTick(fn)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.resolveCallback.push(onFulfill)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'start'</span>)</span><br><span class="line"><span class="keyword">new</span> xPromise(</span><br><span class="line">    (resolve, reject) =&gt; &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            resolve(<span class="number">100</span>)</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">).then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(v)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> xPromise(<span class="function"><span class="params">r</span> =&gt;</span> &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            resolve(<span class="number">1000</span>)</span><br><span class="line">        &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;, e =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e) <span class="comment">//</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(v)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'end'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 控制台输出：</span></span><br><span class="line"><span class="comment"> * start</span></span><br><span class="line"><span class="comment"> * end</span></span><br><span class="line"><span class="comment"> * -&gt; 1s后输出 &lt;100&gt;</span></span><br><span class="line"><span class="comment"> * -&gt; 再等1s后输出 &lt;1000&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p>现在已经实现了大部分功能，我们再具体细化一下实现<code>all</code>/<code>resolve</code>/<code>reject</code>(reject的值必须为Error实例)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xPromise</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> all(promiseArray) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> xPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            promiseArray.forEach(<span class="function">(<span class="params">promise, index</span>) =&gt;</span> &#123;</span><br><span class="line">                promise.then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((result.length - <span class="number">1</span>) === index) &#123;</span><br><span class="line">                        resolve(result)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, e =&gt; &#123;</span><br><span class="line">                    reject(e)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> resolve(value) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> xPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            resolve(value)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> reject(reson) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> xPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            reject(reson)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> promise1 = <span class="keyword">new</span> xPromise(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Fail1'</span>))</span><br><span class="line">    &#125;, <span class="number">500</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> promise2 = <span class="keyword">new</span> xPromise(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        resolve(<span class="string">'promise2'</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line">xPromise.all([</span><br><span class="line">    promise2,</span><br><span class="line">    promise1,</span><br><span class="line">]).then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(v.join(<span class="string">','</span>))</span><br><span class="line">&#125;).catch(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(promise1.status)</span><br><span class="line">    <span class="built_in">console</span>.log(promise2.status)</span><br><span class="line">    <span class="built_in">console</span>.log(e)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">100</span></span><br><span class="line">&#125;).then(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'then'</span>, v)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 控制台输出：</span></span><br><span class="line"><span class="comment">rejected</span></span><br><span class="line"><span class="comment">pending</span></span><br><span class="line"><span class="comment">0.5s后输出：Error: Fail1</span></span><br><span class="line"><span class="comment">    at Timeout._onTimeout (D:\demo\vue-next\Promise.js:174:16)</span></span><br><span class="line"><span class="comment">    at listOnTimeout (internal/timers.js:549:17)</span></span><br><span class="line"><span class="comment">    at processTimers (internal/timers.js:492:7)</span></span><br><span class="line"><span class="comment">then 100</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/Linkontoask/2020/08/10/docker%E4%B8%8D%E5%90%8C%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Link">
      <meta itemprop="description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="记录与分享">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/10/docker%E4%B8%8D%E5%90%8C%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1/" class="post-title-link" itemprop="url">docker不同容器中的网络通信</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-10 16:52:30" itemprop="dateCreated datePublished" datetime="2020-08-10T16:52:30+00:00">2020-08-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-07 03:46:43" itemprop="dateModified" datetime="2021-07-07T03:46:43+00:00">2021-07-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="docker-不同容器中的网络通信"><a href="#docker-不同容器中的网络通信" class="headerlink" title="docker 不同容器中的网络通信"></a>docker 不同容器中的网络通信</h1><p>在 docker 中我们可以借助<code>network</code>这个子级命令，它提供容器之间的通信，分为以下 5 种驱动模式。</p>
<ul>
<li>bridge: 默认的网络驱动模式。如果不指定驱动程序，bridge 便会作为默认的网络驱动模式。当应用程序运行在需要通信的独立容器 (standalone containers) 中时，通常会选择 bridge 模式。</li>
<li>host：移除容器和 Docker 宿主机之间的网络隔离，并直接使用主机的网络。host 模式仅适用于 Docker 17.06+。</li>
<li>overlay：overlay 网络将多个 Docker 守护进程连接在一起，并使集群服务能够相互通信。您还可以使用 overlay 网络来实现 swarm 集群和独立容器之间的通信，或者不同 Docker 守护进程上的两个独立容器之间的通信。该策略实现了在这些容器之间进行操作系统级别路由的需求。</li>
<li>macvlan：Macvlan 网络允许为容器分配 MAC 地址，使其显示为网络上的物理设备。 Docker 守护进程通过其 MAC 地址将流量路由到容器。对于希望直连到物理网络的传统应用程序而言，使用 macvlan 模式一般是最佳选择，而不应该通过 Docker 宿主机的网络进行路由。</li>
<li>none：对于此容器，禁用所有联网。通常与自定义网络驱动程序一起使用。none 模式不适用于集群服务。</li>
</ul>
<p>配置实例：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">mongo:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">mongo</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br></pre></td></tr></table></figure>

<p>我们可以通过<code>mongo</code>这个网络驱动，为不同容器提供网络通信。</p>
<p>docker-compose.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">'3.8'</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">mongo:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">mongo</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mongo</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">27017</span><span class="string">:27017</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mongo</span></span><br><span class="line">  <span class="attr">wait:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mongo</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">/bin/sh</span> <span class="string">wait.sh</span></span><br></pre></td></tr></table></figure>

<p>在 yml 配置文件中，我们配置了一个 wait 容器和 db 容器，他们使用<code>mongo</code>网络环境。</p>
<p>下面是<code>Dockerfile</code>配置文件，基于<code>alpine</code>（<a href="https://alpinelinux.org/" target="_blank" rel="noopener">Alpine Linux</a> is a Linux distribution built around <a href="https://www.musl-libc.org/" target="_blank" rel="noopener">musl libc</a> and <a href="https://www.busybox.net/" target="_blank" rel="noopener">BusyBox</a>）<br>Dockerfile</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FROM alpine</span><br><span class="line"></span><br><span class="line">WORKDIR &#x2F;app</span><br><span class="line"></span><br><span class="line">ADD wait.sh &#x2F;app</span><br></pre></td></tr></table></figure>

<p><code>wait.sh</code>就是让脚本暂停，方便我们 bash 时进行操作。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line"></span><br><span class="line">sleep 1000</span><br></pre></td></tr></table></figure>

<p>在容器运行过程中我们可以使用<code>docker exec -it &lt;docker id&gt; ping db</code>命令，看看能否正常与 db 容器通信，然后再使用<code>docker exec -it &lt;docker id&gt; ping db:27017</code>看看端口是否开启。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">λ docker exec -it a0efed4a8d9b ping -c 2 db</span><br><span class="line">PING db (172.19.0.2): 56 data bytes</span><br><span class="line">64 bytes from 172.19.0.2: seq&#x3D;0 ttl&#x3D;64 time&#x3D;0.169 ms</span><br><span class="line">64 bytes from 172.19.0.2: seq&#x3D;1 ttl&#x3D;64 time&#x3D;0.096 ms</span><br><span class="line"></span><br><span class="line">--- db ping statistics ---</span><br><span class="line">2 packets transmitted, 2 packets received, 0% packet loss</span><br><span class="line">round-trip min&#x2F;avg&#x2F;max &#x3D; 0.096&#x2F;0.132&#x2F;0.169 ms</span><br></pre></td></tr></table></figure>

<p>这个时候我们运行一下<code>docker network ls</code>，看看运行的<code>network</code>的 ID，然后再输入<code>docker network inspect &lt;network id&gt;</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">λ docker network inspect &lt;network id&gt;</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;mongo&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;92d630eadafa764dd40e3145b76f99d700f1d4a198d9ef2a8d73db440c020efd&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2020-08-10T09:06:59.2047684Z&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: null,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;172.19.0.0&#x2F;16&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.19.0.1&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: true,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;</span><br><span class="line">            &quot;82025ba1fe6836858287fe4841b377744ab78a0adf83400b21736a4deb353edf&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;network_db_1&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;cb4701b86ad30d3731fb92c58279bc6fd42cef5725254ecfab218d2ee8f45523&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:ac:13:00:02&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;172.19.0.2&#x2F;16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;a0efed4a8d9b2df37d55e17eb77f9955481c7ff397bd7a3521a738c64edb3383&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;network_wait_1&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;1f20117a0cbda05b26b6479a1681050a5560147875cc467daa18bf420c8074fe&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:ac:13:00:03&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;172.19.0.3&#x2F;16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;</span><br><span class="line">            &quot;com.docker.compose.network&quot;: &quot;mongo&quot;,</span><br><span class="line">            &quot;com.docker.compose.project&quot;: &quot;house&quot;,</span><br><span class="line">            &quot;com.docker.compose.version&quot;: &quot;1.26.2&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>上面我们可以看到有两个容器在这个网络环境中，<code>Containers</code>对象中包含了这两个容器的网络状态。</p>
<ul>
<li>Name：容器名称</li>
<li>MacAddress：容器的 MAC 地址</li>
<li>IPv4Address：容器的 IPV4 地址</li>
<li>IPv6Address：容器的 IPV6 地址</li>
</ul>
<p>上述就是使用<code>docker-compose.yml</code>进行<code>network</code>通信。非<code>docker-compose</code>的形式请参考<a href="https://docs.docker.com/network/bridge/" target="_blank" rel="noopener">https://docs.docker.com/network/bridge/</a></p>
<h2 id="docker-建立用户网络"><a href="#docker-建立用户网络" class="headerlink" title="docker 建立用户网络"></a>docker 建立用户网络</h2><p><code>docker network create my-net</code>，创建一个名为<code>my-net</code>的网络，然后再使用<code>docker network connect my-net my-nginx</code>将已经运行的<code>my-nginx</code>容器加入到<code>my-net</code>网络。<br>也可以使用下面命令，在容器启动的时候添加<code>--network</code>参数，将容器运行在特定的网络环境下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker create --name my-nginx \</span></span><br><span class="line">  --network my-net \</span><br><span class="line">  --publish 8080:80 \</span><br><span class="line">  nginx:latest</span><br></pre></td></tr></table></figure>

<p>如果想断开网络，可以使用<code>docker network disconnect my-net my-nginx</code></p>
<h2 id="nginx-代理到其它容器中的端口上"><a href="#nginx-代理到其它容器中的端口上" class="headerlink" title="nginx 代理到其它容器中的端口上"></a>nginx 代理到其它容器中的端口上</h2><p>在前后端分离的背景下，我们使用<code>nginx</code>提供 web 服务。使用 docker 部署 nginx 时，会遇到代理到不同容器中端口的问题，下面就讲讲如何去解决这一个问题。</p>
<p>第一种，我们使用<code>host</code>网络模式，这会让 nginx 容器置身于主机环境下，共用相同的网络。<br>第二种，我们使用容器名进行桥接。<br>先看看<code>docker-compose.yml</code>配置。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">'3.8'</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">dashboard:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mongo</span></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx</span></span><br></pre></td></tr></table></figure>

<p>这里是<code>nginx.conf</code>配置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name _;</span><br><span class="line"></span><br><span class="line">    location &#x2F;api &#123;</span><br><span class="line">        proxy_set_header        X-Real_IP       $remote_addr;</span><br><span class="line">        proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header        X-NginX-Proxy   true;</span><br><span class="line">        proxy_set_header        Host            $http_host;</span><br><span class="line">        proxy_set_header        Upgrade         $http_upgrade;</span><br><span class="line">        proxy_pass              http:&#x2F;&#x2F;dashboard:9090; # &lt;容器名&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/Linkontoask/2020/08/08/%E4%BD%BF%E7%94%A8docker%E6%89%93%E5%8C%85%E5%89%8D%E7%AB%AF%E5%BA%94%E7%94%A8-webpack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Link">
      <meta itemprop="description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="记录与分享">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/08/%E4%BD%BF%E7%94%A8docker%E6%89%93%E5%8C%85%E5%89%8D%E7%AB%AF%E5%BA%94%E7%94%A8-webpack/" class="post-title-link" itemprop="url">使用docker打包前端应用(webpack)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-08 21:29:05" itemprop="dateCreated datePublished" datetime="2020-08-08T21:29:05+00:00">2020-08-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-07 03:46:43" itemprop="dateModified" datetime="2021-07-07T03:46:43+00:00">2021-07-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="使用docker打包前端应用-webpack"><a href="#使用docker打包前端应用-webpack" class="headerlink" title="使用docker打包前端应用(webpack)"></a>使用docker打包前端应用(webpack)</h1><p>使用docker部署前端应用时，我们要清楚用docker能给我带来什么，以及使用docker带来的成本。</p>
<p>用docker打包前端应用时，需要消耗的资源：</p>
<ul>
<li>学习docker，搭建docker基本运行环境（windows、linux）</li>
<li>了解docker基本原理，以及dockerfile的语法</li>
<li>打包之后的体积优化（非必须）</li>
</ul>
<p>用docker打包前端应用时，带来的好处：</p>
<ul>
<li>可以实现应用的网络隔离</li>
<li>方便集成到CI工具中</li>
<li>形成封闭的运行环境，不会因为nginx等web服务器漏洞导致被攻击</li>
<li>layer缓存，如果没有发生依赖修改的情况下，可以直接使用缓存，提高打包iamge效率</li>
<li>可移植，方便部署到windows、linux或者mac系统上</li>
<li>部署层面的版本控制</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/Linkontoask/2020/08/07/%E5%9C%A8Vue%E4%B8%AD%E4%BD%BF%E7%94%A8sentry/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Link">
      <meta itemprop="description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="记录与分享">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/07/%E5%9C%A8Vue%E4%B8%AD%E4%BD%BF%E7%94%A8sentry/" class="post-title-link" itemprop="url">在Vue中使用sentry</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-07 11:42:15" itemprop="dateCreated datePublished" datetime="2020-08-07T11:42:15+00:00">2020-08-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-07 03:46:43" itemprop="dateModified" datetime="2021-07-07T03:46:43+00:00">2021-07-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="在Vue中如何使用sentry？"><a href="#在Vue中如何使用sentry？" class="headerlink" title="在Vue中如何使用sentry？"></a>在Vue中如何使用sentry？</h1><p>sentry支持多个平台，在新建项目的时候可以发现支持数十种平台。以vue-next项目为例</p>
<p>在入口引入<code>@sentry/browser</code>和<code>@sentry/integrations</code>这两个库，<code>raven-js</code>主要是做自定义上传</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Sentry <span class="keyword">from</span> <span class="string">'@sentry/browser'</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Integrations <span class="keyword">from</span> <span class="string">'@sentry/integrations'</span></span><br><span class="line"><span class="keyword">import</span> Raven <span class="keyword">from</span> <span class="string">'raven-js'</span></span><br><span class="line"><span class="keyword">import</span> &#123;createApp, h&#125; <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> APP <span class="keyword">from</span> <span class="string">'./APP.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = createApp(&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> h(APP)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.mount(<span class="string">'#app'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> configSentry = &#123;</span><br><span class="line">  dsn: <span class="string">'&lt;dsn&gt;'</span>,</span><br><span class="line">  integrations: [<span class="keyword">new</span> Integrations.Vue(&#123; <span class="attr">Vue</span>: app, <span class="attr">attachProps</span>: <span class="literal">true</span> &#125;)],</span><br><span class="line">  debug: <span class="literal">true</span>,</span><br><span class="line">  beforeSend(event, hint) &#123;</span><br><span class="line">    <span class="keyword">if</span> (event.exception) &#123;</span><br><span class="line">      Sentry.showReportDialog(&#123; <span class="attr">eventId</span>: event.event_id &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> event;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'production'</span>) &#123;</span><br><span class="line">  <span class="keyword">delete</span> configSentry.debug</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Sentry.init(configSentry)</span><br><span class="line"></span><br><span class="line">Raven.config(<span class="string">'&lt;dsn&gt;'</span>)</span><br></pre></td></tr></table></figure>

<p>这个时候在sentry控制台中能看到错误日志，但是我们项目是经过webpack编译过后的代码，没有办法阅读。这个时候可以利用<code>@sentry/webpack-plugin</code>这个webpack插件将生成的map文件上传至控制台，然后就可以在issues中看到详细的错误日志。</p>
<p>具体使用实例，更多详细配置请移步<a href="https://github.com/getsentry/sentry-webpack-plugin">github</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SentryPlugin = <span class="built_in">require</span>(<span class="string">'@sentry/webpack-plugin'</span>)</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// ... 其它配置</span></span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> SentryPlugin(&#123;</span><br><span class="line">      include: <span class="string">'dist'</span>,</span><br><span class="line">      release: <span class="string">'1.0.1'</span>,</span><br><span class="line">      debug: <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候需要一些配置，告诉插件我们sentry的地址，我们在项目中创建一个<code>.sentryclirc</code>，当然，这个文件也可以创建在项目的上一层目录或这根目录，因为插件会以当前目录为基础，一层一层的往上找。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[auth]</span><br><span class="line">token &#x3D; &lt;token&gt;</span><br><span class="line">dsn &#x3D; &lt;dsn&gt;</span><br><span class="line"></span><br><span class="line">[defaults]</span><br><span class="line">url &#x3D; &lt;url&gt;</span><br><span class="line">org &#x3D; sentry</span><br><span class="line">project &#x3D; test</span><br></pre></td></tr></table></figure>

<p>auth:   </p>
<ul>
<li>token: 上传凭证，在用户下可以创建一个可读可写的项目token</li>
<li>dsn: 用于确认上传地址和凭证的<code>uri</code>，组成部分<code>{PROTOCOL}://{PUBLIC_KEY}:{SECRET_KEY}@{HOST}/{PATH}{PROJECT_ID}</code></li>
</ul>
<p>defaults:   </p>
<ul>
<li>url: sentry的地址</li>
<li>org: 组织名称</li>
<li>project: 项目名称i</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/Linkontoask/2020/08/07/%E7%94%A8Docker%E9%83%A8%E7%BD%B2sentry%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Link">
      <meta itemprop="description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="记录与分享">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/07/%E7%94%A8Docker%E9%83%A8%E7%BD%B2sentry%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F/" class="post-title-link" itemprop="url">用Docker部署sentry的几种方式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-07 10:49:14" itemprop="dateCreated datePublished" datetime="2020-08-07T10:49:14+00:00">2020-08-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-07 03:46:43" itemprop="dateModified" datetime="2021-07-07T03:46:43+00:00">2021-07-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="用Docker部署sentry的几种方式"><a href="#用Docker部署sentry的几种方式" class="headerlink" title="用Docker部署sentry的几种方式"></a>用Docker部署sentry的几种方式</h1><p><code>sentry</code>是什么呢？我在Github上找到了这个答案。<br>Real-time crash reporting for your web apps, mobile apps, and games.</p>
<p>市场中有很多类似的解决方案，为什么要选择 <code>sentry</code> 来做为我们的应用程序BUG检测的解决方案。</p>
<ul>
<li>开源</li>
<li>社区比较完善</li>
<li>云上有免费额度</li>
</ul>
<h2 id="第一种，使用官方的-onpremise"><a href="#第一种，使用官方的-onpremise" class="headerlink" title="第一种，使用官方的 onpremise"></a>第一种，使用官方的 <code>onpremise</code></h2><p><a href="https://github.com/getsentry/onpremise">onpremise github</a></p>
<p>运行sentry之前，你需要满足一下环境。</p>
<ul>
<li>保证你的服务器内存大于2G</li>
<li>Docker 17.05.0+</li>
<li>Compose 1.23.0+</li>
</ul>
<p>如果你都满足了，那么接下来就是开始安装了。</p>
<ul>
<li>我们将项目clone下来。<br><code>git clone git@github.com:getsentry/onpremise.git</code></li>
<li>运行<code>install.sh</code><br><code>bash install.sh</code></li>
<li>使用<code>docker-compoes</code>后台运行容器<br><code>docker-compoes up -d</code></li>
</ul>
<p>至此，请使用<code>IP:9000</code>连接进行访问，我们可以正常访问sentry的后台。</p>
<p>但是你会发现，<strong>用户名和密码</strong>在哪里？接下来，我们需要创建，我们键入<code>docker-compose run --rm web upgrade</code>，按照提示输入用户名和密码。</p>
<p><code>--rm</code> 代表运行完成后删除容器，仅此运行一次。<br>参数<code>web</code>指<code>yml</code>里容器的名字，相对应命令是<code>docker run -it --rm -e SENTRY_SECRET_KEY=&#39;&lt;secret-key&gt;&#39; --link sentry-postgres:postgres --link sentry-redis:redis sentry upgrade</code></p>
<h2 id="第二种，使用命令行的形式部署"><a href="#第二种，使用命令行的形式部署" class="headerlink" title="第二种，使用命令行的形式部署"></a>第二种，使用命令行的形式部署</h2><p>我们找到Docker的HUB，<a href="https://hub.docker.com/_/sentry/" target="_blank" rel="noopener">sentry hub</a>，然后我们按照上面的操作步骤下来，不过注意的是，执行第5步的时候没有将9000端口映射出来，我们需要稍微变更一下。</p>
<ul>
<li><code>docker run -d --name sentry-redis redis</code></li>
<li><code>docker run -d --name sentry-postgres -e POSTGRES_PASSWORD=secret -e POSTGRES_USER=sentry postgres</code></li>
<li><code>docker run --rm sentry config generate-secret-key</code> （保存这里生成的key）</li>
<li><code>docker run -it --rm -e SENTRY_SECRET_KEY=&#39;&lt;secret-key&gt;&#39; --link sentry-postgres:postgres --link sentry-redis:redis sentry upgrade</code> （这里会提示你输入用户名/邮箱和密码）</li>
<li><code>docker run -d --name my-sentry -p 9000:9000 -e SENTRY_SECRET_KEY=&#39;&lt;secret-key&gt;&#39; --link sentry-redis:redis --link sentry-postgres:postgres sentry</code> （注意-p参数）</li>
<li><code>docker run -d --name sentry-cron -e SENTRY_SECRET_KEY=&#39;&lt;secret-key&gt;&#39; --link sentry-postgres:postgres --link sentry-redis:redis sentry run cron</code></li>
<li><code>docker run -d --name sentry-worker-1 -e SENTRY_SECRET_KEY=&#39;&lt;secret-key&gt;&#39; --link sentry-postgres:postgres --link sentry-redis:redis sentry run worker</code></li>
</ul>
<p>接下来访问<code>IP:9000</code>，输入你第4步键入的邮箱和密码即可登录后台管理系统。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/Linkontoask/2020/07/30/git%E8%BD%AC%E6%8D%A2crlf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Link">
      <meta itemprop="description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="记录与分享">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/30/git%E8%BD%AC%E6%8D%A2crlf/" class="post-title-link" itemprop="url">git将lf转换crlf</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-07-30 15:08:53" itemprop="dateCreated datePublished" datetime="2020-07-30T15:08:53+00:00">2020-07-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-07 03:46:43" itemprop="dateModified" datetime="2021-07-07T03:46:43+00:00">2021-07-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="git-将-lf-转换-crlf"><a href="#git-将-lf-转换-crlf" class="headerlink" title="git 将 lf 转换 crlf"></a>git 将 lf 转换 crlf</h1><p><code>find . -type f | xargs dos2unix</code></p>
<p><a href="https://blog.konghy.cn/2017/03/19/git-lf-or-crlf/" target="_blank" rel="noopener">https://blog.konghy.cn/2017/03/19/git-lf-or-crlf/</a></p>
<p>排除一些文件夹进行转换</p>
<p><code>find . -path &quot;./node_modules&quot; -prune -o -type f -print | xargs dos2unix</code></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://github.com/Linkontoask/2020/07/30/%E4%BD%BF%E7%94%A8webpack%E8%BF%90%E8%A1%8Cvue3%E9%9C%80%E8%A6%81%E5%87%86%E5%A4%87%E7%9A%84%E5%B7%A5%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Link">
      <meta itemprop="description" content="坚持每天进步一点，多学一点“装”的技术，不止步与现状。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="记录与分享">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/30/%E4%BD%BF%E7%94%A8webpack%E8%BF%90%E8%A1%8Cvue3%E9%9C%80%E8%A6%81%E5%87%86%E5%A4%87%E7%9A%84%E5%B7%A5%E4%BD%9C/" class="post-title-link" itemprop="url">使用webpack运行vue3需要准备的工作</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-07-30 15:08:53" itemprop="dateCreated datePublished" datetime="2020-07-30T15:08:53+00:00">2020-07-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-07-07 03:46:43" itemprop="dateModified" datetime="2021-07-07T03:46:43+00:00">2021-07-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="使用webpack运行vue3需要准备的工作"><a href="#使用webpack运行vue3需要准备的工作" class="headerlink" title="使用webpack运行vue3需要准备的工作"></a>使用webpack运行vue3需要准备的工作</h1><p>vue-next已经在rc阶段，周边社区已经基本完善，等待最后发布一个稳定的版本即可投入在小项目中使用。</p>
<h2 id="准备哪些webpack插件？"><a href="#准备哪些webpack插件？" class="headerlink" title="准备哪些webpack插件？"></a>准备哪些webpack插件？</h2><ul>
<li>HtmlWebpackPlugin<br>做前端项目最基本的一个html载体。</li>
<li>vue-loader@next<br>编译.vue文件的插件，需要安装next版本。</li>
<li>vue@next<br>vue3的rc版，和vue2最大的不同就是分离了不同的功能包，比如可以分开导入reactivate、compiler-core。</li>
<li>babel<br>可以使用最新的语法，有很多插件可以帮助我们提高开发效率。</li>
<li>ts-loader<br>支持typescript语法</li>
</ul>
<p>准备一个babel插件以支持jsx</p>
<ul>
<li>@ant-design-vue/babel-plugin-jsx</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Link</p>
  <div class="site-description" itemprop="description">坚持每天进步一点，多学一点“装”的技术，不止步与现状。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Link</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
